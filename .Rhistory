library(plyr) # Data manipulation
library(tidyverse) # Data manipulation
library(mctoolsr) # Microbial analyses
library(RColorBrewer) # Colors
library(vegan) # Multivariate analyses
library(indicspecies) # Indicator species
library(car) # Stats
library(FSA) # SE
library(magrittr) # Set names
library(PMCMRplus) # Stats
library(readxl) # Excel
library(writexl) # Excel
library(plotly) # Interactive plots
library(ggmap) # Maps
library(ggsn) # Maps
library(multcomp) # Tukey HSD and significance letters
library(emmeans) # Tukey HSD and significance letters
library(scales) # View colors
library(cowplot) # Multipanels
library(qvalue) # q values for indicator species
library(reshape2) # melt
library(gridExtra) # graphs
library(grid) # graphs
library(cowplot) # graphs
library(ggpubr) # graphs
library(ggExtra) # graphs
library(ggh4x) # graphs
library(dendextend) # graphs
library(corrplot) # correlation plots
# Functions
find_hull <- function(df) df[chull(df$Axis01, df$Axis02),]
`%notin%` <- Negate(`%in%`)
paste_ranks = function(sm_taxa){
k = data.frame(k ="k_", sm_taxa['taxonomy1'])
k2 <- do.call(paste, c(k, sep = ""))
p = data.frame(k ="p_", sm_taxa['taxonomy2'])
p2 <- do.call(paste, c(p, sep = ""))
c = data.frame(k ="c_", sm_taxa['taxonomy3'])
c2 <- do.call(paste, c(c, sep = ""))
o = data.frame(k ="o_", sm_taxa['taxonomy4'])
o2 <- do.call(paste, c(o, sep = ""))
f = data.frame(k ="f_", sm_taxa['taxonomy5'])
f2 <- do.call(paste, c(f, sep = ""))
g = data.frame(k ="g_", sm_taxa['taxonomy6'])
g2 <- do.call(paste, c(g, sep = ""))
# NOT USING SPECIES HERE! OTU preprocessing doesn't!
s = data.frame(k ="s_", sm_taxa['taxonomy7'])
s2 <- do.call(paste, c(s, sep = ""))
# combine all
lineage_df = data.frame(k2, p2, c2, o2, f2, g2)
lineage = do.call(paste, c(lineage_df, sep = ';'))
return(lineage)
}
# Guild subsetting module from other repository
source("~/Documents/GitHub/SF_microbe_methane/modules/3_OTU_subsetting_modules_v.0.4_strip.r")
# Correlations
source("~/Documents/GitHub/EastCoast/meth_corr_by_taxonomy.R")
#### _North Carolina ####
# input_filt <- readRDS("input_filt.rds")
input_filt <- readRDS("input_filt_wBGC.rds")
#### _North Carolina ####
# input_filt <- readRDS("input_filt.rds")
input_filt <- readRDS("data/input_filt_wBGC.rds")
# Repository path
setwd("~/Documents/GitHub/EastCoast/")
#### _North Carolina ####
# input_filt <- readRDS("input_filt.rds")
input_filt <- readRDS("data/input_filt_wBGC.rds")
nc <- filter_data(input_filt,
filter_cat = "Estuary",
keep_vals = "Alligator")
