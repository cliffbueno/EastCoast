# Salinity, pH, SO4, sed SO4
# TOC, DIC, DOC
# TN, DIN, DON
# NH4, sed_NH4, NO3, sed_NO3
# PO4, sed_PO4
# % C, % N, C:N
metaComb_long_shared <- metaComb_long %>%
filter(variable == "CH4_ug_m2_h" |
variable == "CO2_ug_m2_h" |
variable == "Salinity_ppt_all" |
variable == "pH" |
variable == "SO4_mgL" |
variable == "sed_SO4_mgL" |
variable == "TOC_mgL" |
variable == "DIC_mgL" |
variable == "DOC_mgL" |
variable == "TN_mgL" |
variable == "DIN_mgL" |
variable == "DON_mgL" |
variable == "NH4_mgL" |
variable == "sed_NH4_mgL" |
variable == "NO3_mgL" |
variable == "sed_NO3_mgL" |
variable == "PO4_mgL" |
variable == "sed_PO4_mgL" |
variable == "sed_per_C" |
variable == "sed_per_N" |
variable == "sed_CN") %>%
mutate(variable = factor(variable,
levels = c("CH4_ug_m2_h", "CO2_ug_m2_h",
"Salinity_ppt_all", "pH", "SO4_mgL",
"sed_SO4_mgL", "TOC_mgL", "DIC_mgL",
"DOC_mgL", "TN_mgL", "DIN_mgL", "DON_mgL",
"NH4_mgL", "sed_NH4_mgL", "NO3_mgL",
"sed_NO3_mgL", "PO4_mgL", "sed_PO4_mgL",
"sed_per_C", "sed_per_N", "sed_CN")))
ggplot(metaComb_long_shared, aes(Estuary, value, color = Estuary)) +
geom_boxplot() +
scale_color_viridis_d() +
facet_wrap(~ variable, scales = "free_y") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
ggplot(metaComb_long_shared, aes(Estuary, value, color = Estuary)) +
geom_boxplot() +
scale_color_viridis_d() +
facet_wrap(~ variable, scales = "free_y", ncol = 4) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
ggplot(metaComb_long_shared, aes(Estuary, value, color = Estuary)) +
geom_boxplot() +
scale_color_viridis_d() +
facet_wrap(~ variable, scales = "free_y", ncol = 4) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank(),
legend.position = "none")
plot_panel <- function(data, x, y) {
ggplot(data, aes(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank(),
legend.position = "none")
}
p1 <- plot_panel(data = metaComb, x = Estuary, y = CH4_ug_m2_h)
p1
p1 <- plot_panel(data = "metaComb", x = "Estuary", y = "CH4_ug_m2_h")
p1 <- plot_panel(data = metaComb, x = metaComb$Estuary, y = metaComb$CH4_ug_m2_h)
p1
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank(),
legend.position = "none")
}
vars <- levels(metaComb_long_shared$variable)
length(vars)
which(names(metaComb) == vars[1])
which(names(metaComb) == vars[2])
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = metaComb$Estuary,
y = metaComb[,which(names(metaComb) == vars[i])])
}
rm(p1)
p[[1]]
p[[2]]
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "none")
}
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = metaComb$Estuary,
y = metaComb[,which(names(metaComb) == vars[i])])
}
p[[2]]
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i])
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = metaComb$Estuary,
y = metaComb[,which(names(metaComb) == vars[i])])
}
p[[2]]
p[[2]]
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "none")
}
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = metaComb$Estuary,
y = metaComb[,which(names(metaComb) == vars[i])])
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = metaComb$Estuary,
y = metaComb[,which(names(metaComb) == vars[i])])
}
p[[2]]
library(cowplot)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], NULL,
align = "hv")
p[[1]]
p1 <- plot_panel(data = metaComb, x = metaComb$Estuary, y = metaComb$CH4_ug_m2_h)
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = Estuary,
y = vars[i]))
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = Estuary,
y = vars[i])
}
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = Estuary,
y = vars[i])
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = "Estuary",
y = vars[i])
}
p[[1]]
p[[2]]
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], NULL,
align = "hv")
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 10, height = 10)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], NULL,
align = "hv",
ncol = 4)
dev.off()
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
legend.position = "none")
}
fw <- ggplot(metaComb_long_shared, aes(Estuary, value, color = Estuary)) +
geom_boxplot() +
scale_color_viridis_d() +
facet_wrap(~ variable, scales = "free_y", ncol = 4) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title = element_blank(),
legend.position = "right")
leg <- get_legend(fw)
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_blank(),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = "Estuary",
y = vars[i])
}
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 10, height = 10)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], leg,
align = "hv",
ncol = 4)
dev.off()
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y, color = x)) +
geom_boxplot() +
scale_color_viridis_d() +
scale_x_discrete(labels = c("SC", "NC", "DE", "SF")) +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = "Estuary",
y = vars[i])
}
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 10, height = 10)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], leg,
align = "hv",
ncol = 4)
dev.off()
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y)) +
geom_boxplot() +
scale_x_discrete(labels = c("SC", "NC", "DE", "SF")) +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = "Estuary",
y = vars[i])
}
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 10, height = 10)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], leg,
align = "hv",
ncol = 4)
dev.off()
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y)) +
geom_boxplot() +
scale_x_discrete(labels = c("SC", "NC", "DE", "SF")) +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
legend.position = "none")
}
p <- list()
for (i in 1:length(vars)) {
p[[i]] <- plot_panel(data = metaComb,
x = "Estuary",
y = vars[i])
}
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 10, height = 10)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], NULL,
align = "hv",
ncol = 4)
dev.off()
pdf("InitialFigs/Comb_All_Biogeochem_CNPS.pdf", width = 8, height = 8)
plot_grid(p[[1]], p[[2]], NULL, NULL,
p[[3]], p[[4]], p[[5]], p[[6]],
p[[7]], p[[8]], p[[9]], NULL,
p[[10]], p[[11]], p[[12]], NULL,
p[[13]], p[[14]], p[[15]], p[[16]],
p[[17]], p[[18]], NULL, NULL,
p[[19]], p[[20]], p[[21]], NULL,
align = "hv",
ncol = 4)
dev.off()
#### _CH4 ####
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth() +
scale_color_viridis_d() +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth() +
scale_y_log10() +
scale_color_viridis_d() +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank())
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
theme_bw() +
theme(legend.position = "none")
pdf("InitialFigs/Comb_All_CH4.pdf", width = 7, height = 5)
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
theme_bw() +
theme(legend.position = "none")
dev.off()
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw()
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw() +
theme(legend.position = "none")
#### _CH4/Salinity ####
# Show trends by estuary
pdf("InitialFigs/Comb_All_CH4_Salinity.pdf", width = 8, height = 3)
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = "CH4 (ug/m2/h)") +
theme_bw() +
theme(legend.position = "none")
dev.off()
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)")) +
theme_bw() +
theme(legend.position = "none")
#### _CH4/Salinity ####
# Show trends by estuary
pdf("InitialFigs/Comb_All_CH4_Salinity.pdf", width = 8, height = 3)
ggplot(metaComb, aes(Salinity_ppt_all, CH4_ug_m2_h)) +
geom_point(aes(color = Estuary)) +
geom_smooth(method = "lm") +
scale_y_log10() +
scale_color_viridis_d() +
facet_wrap(~ Estuary, ncol = 4) +
labs(x = "Salinity (ppt)",
y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)")) +
theme_bw() +
theme(legend.position = "none")
dev.off()
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
theme_bw() +
theme(legend.position = "none")
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
labs(x = "Estuary",
y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)")) +
theme_bw() +
theme(legend.position = "none")
pdf("InitialFigs/Comb_All_CH4.pdf", width = 7, height = 5)
ggplot(metaComb, aes(Estuary, CH4_ug_m2_h, colour = Estuary)) +
geom_boxplot(outlier.shape = NA) +
geom_jitter() +
scale_y_log10() +
scale_color_viridis_d() +
labs(x = "Estuary",
y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)")) +
theme_bw() +
theme(legend.position = "none")
dev.off()
