library(plyr)
library(tidyverse)
library(readxl)
library(reshape2)
library(cowplot)
# Working directory (repo)
setwd("~/Documents/GitHub/EastCoast/")
# Functions
plot_panel <- function(data, x, y) {
ggplot(data, aes_string(x, y)) +
geom_boxplot() +
scale_x_discrete(labels = c("SC", "NC", "DE", "SF")) +
labs(x = NULL,
y = vars[i]) +
theme_bw() +
theme(axis.text.x = element_text(size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 8),
legend.position = "none")
}
#### DE Biogeochem ####
# Dealt with in Excel, see Biogeochem_DE.xlsx
# Assigned sampleIDs, matched to sequence data
# Note: all porewater data
metaDE <- read_excel("~/Documents/GitHub/EastCoast/data/Biogeochem_DE.xlsx",
sheet = 3) %>%
filter(sampleID != "NA") %>%
mutate_at(14:33, as.numeric) %>%
mutate(Salinity_ppt_all = Cl_mgL/1000,
N2O = `N2O Flux umol m-2 hr-1`,
N2O_ug_m2_h = (44.013 * N2O),
TotalVFA_uM = `Total VFA (uM)`,
SR_umol_cm3_d = `SR (umol cm-3 d-1)`,
AMG_umol_cm3_d = `AMG (umol cm-3 d-1)`,
CO2_ug_m2_h = NA,
TOC_mgL = NA,
TN_mgL = NA,
Br_mgL = NA,
NO3_mgL = NA,
DIN_mgL = NA,
DON_mgL = NA,
pH = NA,
DOC_mgL = NA,
Na_mgL = NA,
K_mgL = NA,
Ca_mgL = NA,
Mn_mgL = NA,
Mg_mgL = NA,
Cu_mgL = NA,
Zn_mgL = NA,
Estuary = "Delaware",
Salinity = NA,
sed_per_C = NA,
sed_per_N = NA,
sed_CN = NA,
sed_per_org = NA,
sed_per_inorg = NA,
Conductivity_uS_cm = NA,
CH4_pw_air_ppmv = NA,
N2_umol_m2_h = NA,
SOD_umol_m2_h = NA,
NO3_umol_m2_h = NA,
NH4_umol_m2_h = NA,
SRP_umol_m2_h = NA,
DON_umol_m2_h = NA,
NEE_mgC_m2_m = NA,
GEP_mgC_m2_m = NA,
PAR_uE_m2_s = NA,
CH4_pot_umol_gdw_h = NA,
CO2_pot_umol_gdw_h = NA,
sed_pH = NA,
sed_NH4_mgL = NA,
sed_NO3_mgL = NA,
sed_PO4_mgL = NA,
sed_Cl_mgL = NA,
sed_SO4_mgL = NA,
sed_Bulk_dens = NA,
sed_Fe_mgL = NA,
sed_Mn_mgL = NA,
sed_Cu_mgL = NA,
sed_Zn_mgL = NA,
DIC_mgL = NA) %>%
dplyr::select(Estuary, sampleID, Salinity_calcd_ppt, Salinity, Salinity_ppt_all,
Conductivity_uS_cm, CH4_pw_air_ppmv,
CH4_ug_m2_h, N2O_ug_m2_h, CO2_ug_m2_h,
NEE_mgC_m2_m, GEP_mgC_m2_m, PAR_uE_m2_s,
CH4_pot_umol_gdw_h, CO2_pot_umol_gdw_h,
Cl_mgL, SO4_mgL, NH4_mgL, NO3_mgL, pH, PO4_mgL,
Fe_mgL, Acetate_mgL, TotalVFA_uM, SR_umol_cm3_d, AMG_umol_cm3_d,
TOC_mgL, TN_mgL, Br_mgL, DIN_mgL, DON_mgL, DOC_mgL, DIC_mgL, Na_mgL,
K_mgL, Ca_mgL, Mn_mgL, Mg_mgL, Cu_mgL, Zn_mgL,
sed_pH, sed_NH4_mgL, sed_NO3_mgL, sed_PO4_mgL, sed_Cl_mgL, sed_SO4_mgL,
sed_per_C, sed_per_N, sed_CN, sed_per_org, sed_per_inorg,
sed_Bulk_dens, sed_Fe_mgL, sed_Mn_mgL, sed_Cu_mgL, sed_Zn_mgL,
N2_umol_m2_h,	SOD_umol_m2_h,	NO3_umol_m2_h,	NH4_umol_m2_h,
SRP_umol_m2_h,	DON_umol_m2_h, Porosity)
ggplot(metaDE, aes(Salinity_ppt_all, Salinity_calcd_ppt)) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
geom_point()
View(metaDE)
ggplot(metaDE, aes(Salinity_ppt_all, Salinity_calcd_ppt)) +
geom_abline(slope = 1, intercept = 0, linetype = "dashed") +
geom_point()
check <- metaDE %>%
separate(sampleID, sep = "_")
check <- metaDE %>%
separate(sampleID, into = c("Depth", "Site", "Blah1", "Blah2", "Blah3"), sep = "_") %>%
select(Site, Salinity_ppt_all)
View(check)
check <- metaDE %>%
separate(sampleID, into = c("Depth", "Site", "Blah1", "Blah2", "Blah3"), sep = "_") %>%
select(Site, Salinity_ppt_all) %>%
group_by(Site) %>%
summarize(mean_ppt = mean(Salinity_ppt_all, na.rm = T))
View(check)
