Level = "Guild",
Taxon = rownames(.)) %>%
arrange(match(Taxon, Guild_cols$Guild)) %>%
mutate(Sig = ifelse(pvalsFDR < 0.05, "Yes", "No")) %>%
mutate(SaltEffect = ifelse(Sig == "Yes",
ifelse(Freshwater > Oligohaline, "-", "+"),
""))
# DE Lab
tax_sum_phyla_deinc <- summarize_taxonomy(input = deinc, level = 2, report_higher_tax = F) %>%
filter(rownames(.) %in% barsP$taxon)
res_phy_deinc <- taxa_summary_by_sample_type(taxa_smry_df = tax_sum_phyla_deinc,
metadata_map = de$map_loaded,
type_header = 'Salt',
test_type = 'MW') %>%
mutate(Estuary = "Delaware Lab",
Level = "Phylum",
Taxon = rownames(.)) %>%
arrange(desc(Taxon)) %>%
mutate(Sig = ifelse(pvalsFDR < 0.05, "Yes", "No")) %>%
mutate(SaltEffect = ifelse(Sig == "Yes",
ifelse(Freshwater > Oligohaline, "-", "+"),
""))
tax_sum_guilds_deinc <- summarize_taxonomy(input = deinc, level = 9, report_higher_tax = F) %>%
filter(rownames(.) %in% barsG$taxon)
res_gui_deinc <- taxa_summary_by_sample_type(taxa_smry_df = tax_sum_guilds_deinc,
metadata_map = de$map_loaded,
type_header = 'Salt',
test_type = 'MW') %>%
mutate(Estuary = "Delaware Lab",
Level = "Guild",
Taxon = rownames(.)) %>%
arrange(match(Taxon, Guild_cols$Guild)) %>%
mutate(Sig = ifelse(pvalsFDR < 0.05, "Yes", "No")) %>%
mutate(SaltEffect = ifelse(Sig == "Yes",
ifelse(Freshwater > Oligohaline, "-", "+"),
""))
tax_sum_phyla_sf <- summarize_taxonomy(input = sf, level = 2, report_higher_tax = F) %>%
filter(rownames(.) %in% barsP$taxon)
res_phy_sf <- taxa_summary_by_sample_type(taxa_smry_df = tax_sum_phyla_sf,
metadata_map = sf$map_loaded,
type_header = 'Salt',
test_type = 'MW') %>%
mutate(Estuary = "SF",
Level = "Phylum",
Taxon = rownames(.)) %>%
arrange(desc(Taxon)) %>%
mutate(Sig = ifelse(pvalsFDR < 0.05, "Yes", "No")) %>%
mutate(SaltEffect = ifelse(Sig == "Yes",
ifelse(Freshwater > Oligohaline, "-", "+"),
""))
tax_sum_guilds_sf <- summarize_taxonomy(input = sf, level = 9, report_higher_tax = F) %>%
filter(rownames(.) %in% barsG$taxon)
res_gui_sf <- taxa_summary_by_sample_type(taxa_smry_df = tax_sum_guilds_sf,
metadata_map = sf$map_loaded,
type_header = 'Salt',
test_type = 'MW') %>%
mutate(Estuary = "SF",
Level = "Guild",
Taxon = rownames(.)) %>%
arrange(match(Taxon, Guild_cols$Guild)) %>%
mutate(Sig = ifelse(pvalsFDR < 0.05, "Yes", "No")) %>%
mutate(SaltEffect = ifelse(Sig == "Yes",
ifelse(Freshwater > Oligohaline, "-", "+"),
""))
# New (divided DE)
taxa_results <- rbind(res_phy_sf, res_phy_sc, res_phy_detra, res_phy_deinc, res_phy_nc,
res_gui_sf, res_gui_sc, res_gui_detra, res_gui_deinc, res_gui_nc)
View(taxa_results)
res_phy <- res_phy_sc %>%
mutate(WA = SaltEffect) %>%
dplyr::select(Level, Taxon, WA) %>%
mutate(AL = res_phy_nc$SaltEffect,
DEF = res_phy_detra$SaltEffect,
DEL = res_phy_deinc$SaltEffect,
SF = res_phy_sf$SaltEffect)
View(res_phy)
res_phy <- res_phy_sc %>%
mutate(WA = SaltEffect) %>%
mutate(AL = res_phy_nc$SaltEffect,
DEF = res_phy_detra$SaltEffect,
DEL = res_phy_deinc$SaltEffect,
SF = res_phy_sf$SaltEffect) %>%
dplyr::select(Level, Taxon, SF, WA, DEF, DEL, AL)
View(res_phy)
res_gui <- res_gui_sc %>%
mutate(WA = SaltEffect) %>%
mutate(AL = res_gui_nc$SaltEffect,
DEF = res_gui_detra$SaltEffect,
DEL = res_gui_deinc$SaltEffect,
SF = res_gui_sf$SaltEffect) %>%
dplyr::select(Level, Taxon, SF, WA, DEF, DEL, AL)
res <- rbind(res_phy, res_gui)
View(res)
write_xlsx(res, "taxa_results_unformatted.xlsx", format_headers = F)
brewer.pal(12, "Paired")
ggplot(frol$map_loaded, aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c("Waccamaw", "Alligator", "Delaware", "SF"),
values = c(21, 22, 23, 24)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
ggplot(frol$map_loaded, aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c("Waccamaw", "Alligator", "Delaware", "SF"),
values = c(21, 22, 23, 24)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
View(frol$map_loaded)
# No data, extract from Weston et al. 2011
n1 <- 0.6 * 16050
n1
n2 <- 1.6 * 16050
for (i in 1:nrow(frol$map_loaded)) {
if (frol$map_loaded$sampleID[i] == "TS_FW_d1_12_1") {
frol$map_loaded$CH4_ug_m2_h[i] <- n1
}
}
for (i in 1:nrow(frol$map_loaded)) {
if (frol$map_loaded$sampleID[i] == "TS_SW_d1_12_1") {
frol$map_loaded$CH4_ug_m2_h[i] <- n2
}
}
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab",),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(deinc$map_loaded$CH4_ug_m2_h) + max(deinc$map_loaded$CH4_ug_m2_h)/10,
max(deinc$map_loaded$CH4_ug_m2_h) + max(deinc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(deinc$map_loaded$CH4_ug_m2_h) + max(deinc$map_loaded$CH4_ug_m2_h)/10,
max(deinc$map_loaded$CH4_ug_m2_h) + max(deinc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
n1 + n1/10,
n2 + n2/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
n2 + n2/10,
n2 + n2/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
6.93 + 6.93/10,
1.61 + 1.61/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
# No data, extract from Weston et al. 2006 (not 2011! 2011 shows increase with salt)
# Note these are in umol/cm3
for (i in 1:nrow(frol$map_loaded)) {
if (frol$map_loaded$sampleID[i] == "TS_FW_d1_12_1") {
frol$map_loaded$CH4_ug_m2_h[i] <- 6.93
}
}
for (i in 1:nrow(frol$map_loaded)) {
if (frol$map_loaded$sampleID[i] == "TS_SW_d1_12_1") {
frol$map_loaded$CH4_ug_m2_h[i] <- 1.61
}
}
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
6.93 + 6.93/10,
1.61 + 1.61/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
label_df2 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sf$map_loaded$CH4_ug_m2_h) + max(sf$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(sc$map_loaded$CH4_ug_m2_h) + max(sc$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
max(detra$map_loaded$CH4_ug_m2_h) + max(detra$map_loaded$CH4_ug_m2_h)/10,
6.93 + 6.93/10,
6.93 + 6.93/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10,
max(nc$map_loaded$CH4_ug_m2_h) + max(nc$map_loaded$CH4_ug_m2_h)/10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "a", "b", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
# Only use top depth (data is repeated)
# Remove depth fill
png("FinalFigs/Figure5.png", width = 8, height = 4, units = "in", res = 300)
ggplot(subset(frol$map_loaded, Depth == "0-5"), aes(Salt, CH4_ug_m2_h)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = label_df2, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = expression(""*CH[4]*" flux (µg/"*m^2*"/h)"),
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2)) +
facet_nested_wrap(~ Exp + Estuary2, scales = "free_y", nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
dev.off()
