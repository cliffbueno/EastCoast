labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
mutate(y = max + log10(max) + ((max-min)/10))
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
mutate(y = max + max/10)
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
mutate(y = max + max/5)
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
mutate(y = max + max/2)
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanY <- metaComb_long %>%
group_by(variable) %>%
summarise(varmax = max(value, na.rm = T))
View(meanY)
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
left_join(., meanY, by = "variable")
View(meanlab)
meanY <- metaComb_long %>%
group_by(variable) %>%
summarise(varmax = max(value, na.rm = T)) %>%
mutate(y = varmax + max/2)
meanY <- metaComb_long %>%
group_by(variable) %>%
summarise(varmax = max(value, na.rm = T)) %>%
mutate(y = varmax + varmax/2)
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
left_join(., meanY, by = "variable")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
library(ggrepel) # repel text
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 1,
label.padding = 0.2) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 2,
point.padding = 0.2) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 2,
direction = "y",
point.padding = 0.2) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
meanY <- metaComb_long %>%
group_by(variable) %>%
summarise(varmax = max(value, na.rm = T)) %>%
mutate(y = varmax + varmax/1.9)
meanlab <- metaComb_long %>%
group_by(Estuary2, Salt, variable) %>%
summarise(mean = round(mean(value, na.rm = T), 1),
max = max(value, na.rm = T),
min = min(value, na.rm = T)) %>%
left_join(., meanY, by = "variable")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 2,
direction = "y",
point.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = Inf,
direction = "y",
point.padding = 0.25,
box.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = Inf,
direction = "y",
box.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = Inf,
direction = "y",
box.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 2,
direction = "y",
box.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
png("FinalFigs/FigureS7.png", width = 8, height = 6, units = "in", res = 300)
ggplot(metaComb_long, aes(Estuary2, value, color = Estuary2)) +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_point(size = 2, alpha = 0.75, position = position_jitterdodge(),
aes(shape = Estuary2, colour = Salt)) +
geom_text_repel(data = meanlab,
aes(Estuary2, y, group = Salt, label = mean),
position = position_dodge(width = 0.9),
size = 2, color = "black", inherit.aes = F,
min.segment.length = 2,
direction = "y",
box.padding = 0.1) +
labs(x = "Site",
colour = "Salinity",
fill = "Depth (cm)",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_fill_manual(values = c("black", "white")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_wrap2(~ variable, scales = "free_y", labeller = as_labeller(facet_names),
strip = strip, ncol = 3) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.y = element_blank()) +
theme(strip.text = element_text(size = 6),
axis.text = element_text(size = 6),
legend.position = "right")
dev.off()
