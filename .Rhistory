ggplot(frol$map_loaded, aes(Salt, NTI)) +
geom_hline(yintercept = 2, linetype = "dashed") +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
#geom_text(data = label_df2, aes(x, y, label = label),
#          size = 4, color = "black", inherit.aes = F) +
labs(y = "NTI",
colour = "Salinity",
shape = "Site") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
scale_fill_manual(values = c("black", "white")) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
ggplot(frol$map_loaded, aes(Salt, NTI)) +
geom_hline(yintercept = 2, linetype = "dashed") +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
#geom_text(data = label_df2, aes(x, y, label = label),
#          size = 4, color = "black", inherit.aes = F) +
labs(y = "NTI",
colour = "Salinity",
shape = "Site",
fill = "Depth (cm)") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
scale_fill_manual(values = c("black", "white")) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
Anova(m1, type = "II")
m2 <- aov(NTI ~ EstSalt, data = frol$map_loaded)
shapiro.test(m2$residuals) # Normal
summary(m2)
t2 <- emmeans(object = m2, specs = "EstSalt") %>%
cld(object = ., adjust = "Tukey", Letters = letters, alpha = 0.05) %>%
mutate(name = "rich",
y = max(frol$map_loaded$NTI)+(max(frol$map_loaded$NTI)-min(frol$map_loaded$NTI))/20)
View(t2)
levels(frol$map_loaded$Estuary3)
leveneTest(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "SF"))
shapiro.test(frol$map_loaded$NTI)
t.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "SF")) # Sig.
wilcox.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "SF")) # Sig.
t.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "Waccamaw")) # Sig.
wilcox.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "Waccamaw")) # Sig.
t.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "DE Field")) # Sig.
wilcox.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "DE Field")) # Sig.
t.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "DE Lab")) # Sig.
wilcox.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "DE Lab")) # Sig.
t.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "Alligator")) # Sig.
wilcox.test(NTI ~ Salt, data = subset(frol$map_loaded, Estuary3 == "Alligator")) # Sig.
label_df3 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(10, 10, 10, 10, 10, 10, 10, 10, 10, 10),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "", "", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(frol$map_loaded, aes(Salt, NTI)) +
geom_hline(yintercept = 2, linetype = "dashed") +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
geom_text(data = label_df3, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = "NTI",
colour = "Salinity",
shape = "Site",
fill = "Depth (cm)") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
scale_fill_manual(values = c("black", "white")) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
label_df3 <- data.frame("Exp" = c("Obs", "Obs",
"Field", "Field",
"Field", "Field",
"Lab", "Lab",
"Lab", "Lab"),
"Estuary2" = c("SF", "SF",
"Waccamaw", "Waccamaw",
"Delaware", "Delaware",
"Delaware", "Delaware",
"Alligator", "Alligator"),
"y" = c(10.1, 10.1, 10.1, 10.1, 10.1, 10.1, 10.1, 10.1, 10.1, 10.1),
"x" = c("Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline", "Freshwater", "Oligohaline",
"Freshwater", "Oligohaline"),
"label" = c("a", "b", "a", "b", "", "", "", "", "a", "b")) %>%
mutate(Exp = factor(Exp, levels = c("Obs", "Field", "Lab"))) %>%
mutate(Estuary2 = factor(Estuary2, levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
ggplot(frol$map_loaded, aes(Salt, NTI)) +
geom_hline(yintercept = 2, linetype = "dashed") +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
geom_text(data = label_df3, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = "NTI",
colour = "Salinity",
shape = "Site",
fill = "Depth (cm)") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
scale_fill_manual(values = c("black", "white")) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
png("FinalFigs/FigureS3.png", width = 8, height = 4, units = "in", res = 300)
ggplot(frol$map_loaded, aes(Salt, NTI)) +
geom_hline(yintercept = 2, linetype = "dashed") +
geom_boxplot(outlier.shape = NA, aes(colour = Salt)) +
geom_jitter(size = 2, alpha = 0.75, width = 0.2,
aes(fill = Depth, shape = Estuary2, colour = Salt)) +
geom_text(data = label_df3, aes(x, y, label = label),
size = 4, color = "black", inherit.aes = F) +
labs(y = "NTI",
colour = "Salinity",
shape = "Site",
fill = "Depth (cm)") +
scale_colour_manual(values = c("blue", "red")) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
scale_fill_manual(values = c("black", "white")) +
guides(shape = guide_legend(order = 1,),
colour = guide_legend(order = 2),
fill = guide_legend(override.aes = list(shape = c(16, 1)), order = 3)) +
facet_nested_wrap(~ Exp + Estuary2, nrow = 1) +
theme_bw() +
theme(legend.position = "right",
legend.spacing.y = unit(0.1, "cm"),
legend.margin = margin(0.25, 0, 0, -0.1, unit = "cm"),
legend.key.size = unit(0.4, "cm"),
axis.title.y = element_text(size = 12),
axis.title.x = element_blank(),
axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10, angle = 45, hjust = 1),
strip.text = element_text(size = 10))
dev.off()
plot_usmap()
plot_usmap(regions = "states")
plot_usmap(regions = "counties") +
labs(title = "US Counties",
subtitle = "This is a blank map of the counties of the United States.") +
theme(panel.background = element_rect(color = "black", fill = "lightblue"))
plot_usmap(include = c("CA", "ID", "NV", "OR", "WA")) +
labs(title = "Western US States",
subtitle = "These are the states in the Pacific Timezone.")
plot_usmap(data = statepop, values = "pop_2015", color = "red") +
scale_fill_continuous(name = "Population (2015)", label = scales::comma) +
theme(legend.position = "right")
plot_usmap()
plot_usmap(exclude = c("AK", "HI"))
plot_usmap(exclude = c("AK", "HI")) +
scale_fill_manual(values = "black")
plot_usmap(exclude = c("AK", "HI"))
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80")
#### 5. Map ####
# Need map as Figure S1
# Just basic US map with points on the 4 sites
input_filt_rare <- readRDS("input_filt_rare.rds")
coords <- input_filt_rare$map_loaded %>%
group_by(Latitude, Longitude) %>%
slice_head()
View(coords)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80") +
geom_point(data = coords,
aes(x = Longitude, y = Latitude), size = 4)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80") +
geom_point(data = coords,
aes(x = Longitude, y = Latitude), size = 1)
#### 5. Map ####
# Need map as Figure S1
# Just basic US map with points on the 4 sites
input_filt_rare <- readRDS("input_filt_rare_comb_wBGC.rds")
coords <- input_filt_rare$map_loaded %>%
group_by(Latitude, Longitude) %>%
slice_head()
test_data <- data.frame(lon = coords$Longitude, lat = coords$Latitude)
transformed_data <- usmap_transform(test_data)
View(coords)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80") +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
View(coords)
View(transformed_data)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 1) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.1) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.5) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.25) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey90",
size = 0.25) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
#### 5. Map ####
# Need map as Figure S1
# Just basic US map with points on the 4 sites
coords <- data.frame(Estuary2 = c("SF", "Waccamaw", "Delaware", "Alligator"),
Longitude = c(-121.624, -79.0919, -75.17314722, -76.1569),
Latitude = c(38.001, 33.5250, 39.85918056, 35.9061))
#### 5. Map ####
# Need map as Figure S1
# Just basic US map with points on the 4 sites
coords <- data.frame(Estuary2 = c("SF", "Waccamaw", "Delaware", "Alligator"),
Longitude = c(-121.624, -79.0919, -75.17314722, -76.1569),
Latitude = c(38.001, 33.5250, 39.85918056, 35.9061)) %>%
mutate(Estuary2 = factor(Estuary2,
levels = c("SF", "Waccamaw", "Delaware", "Alligator")))
test_data <- data.frame(lon = coords$Longitude, lat = coords$Latitude)
transformed_data <- usmap_transform(test_data)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = transformed_data,
aes(x = x, y = y),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = transformed_data,
aes(x = x, y = y, shape = Estuary2),
color = "red",
size = 3)
View(test_data)
View(transformed_data)
coords$x <- transformed_data$x
coords$y <- transformed_data$y
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
color = "red",
size = 3)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
color = "red",
size = 3) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22))
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 3) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22))
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 3) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
View(coords)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y - 100000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 100000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
png("FinalFigs/FigureS1.png", width = 6, height = 4, units = "in", res = 300)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 100000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
dev.off()
png("FinalFigs/FigureS1.png", width = 6, height = 4, units = "in", res = 300)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 110000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
dev.off()
png("FinalFigs/FigureS1.png", width = 6, height = 4, units = "in", res = 300)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 120000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
dev.off()
png("FinalFigs/FigureS1.png", width = 6, height = 4, units = "in", res = 300)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 150000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
dev.off()
png("FinalFigs/FigureS1.png", width = 6, height = 4, units = "in", res = 300)
plot_usmap(exclude = c("AK", "HI"),
color = "white",
fill = "grey80",
size = 0.3) +
geom_point(data = coords,
aes(x = x, y = y, shape = Estuary2),
fill = "red",
color = "red",
size = 4) +
geom_text(data = coords,
aes(x = x, y = y + 130000, label = Estuary2),
size = 4) +
scale_shape_manual(breaks = c( "SF", "Waccamaw", "Delaware", "Alligator"),
values = c(24, 21, 23, 22)) +
theme(legend.position = "none")
dev.off()
